{
  "name": "Full Reconnaissance and Vulnerability Assessment",
  "description": "Comprehensive network reconnaissance with vulnerability scanning and AI-powered analysis",
  "nodes": [
    {
      "id": "full-recon",
      "type": "mcp_call",
      "mcp_server": "nmap_recon",
      "tool": "full_recon",
      "params": {
        "target": "scanme.nmap.org"
      }
    },
    {
      "id": "vulnerability-scan",
      "type": "mcp_call",
      "mcp_server": "nmap_recon",
      "tool": "vulnerability_scan",
      "params": {
        "target": "scanme.nmap.org",
        "scripts": "vuln"
      }
    },
    {
      "id": "analyze-security",
      "type": "mcp_call",
      "mcp_server": "agent",
      "tool": "think",
      "params": {
        "prompt": "You are a cybersecurity analyst. Analyze these comprehensive network reconnaissance results:\n\nFull Recon: ${full-recon}\n\nVulnerability Scan: ${vulnerability-scan}\n\nProvide a detailed security assessment including:\n1. Attack surface analysis\n2. Critical vulnerabilities identified\n3. Risk assessment (High/Medium/Low)\n4. Prioritized remediation recommendations\n5. Defense strategy suggestions"
      }
    },
    {
      "id": "generate-remediation-plan",
      "type": "mcp_call",
      "mcp_server": "agent",
      "tool": "code",
      "params": {
        "spec": "Create a Python script that generates a JSON remediation plan with prioritized security tasks based on this analysis: ${analyze-security.reasoning}",
        "language": "python"
      }
    },
    {
      "id": "save-full-report",
      "type": "mcp_call",
      "mcp_server": "file_tools",
      "tool": "write_file",
      "params": {
        "path": "security_assessment_report.md",
        "content": "# Network Security Assessment Report\n\n**Target:** scanme.nmap.org\n**Date:** Generated by MCP Agent Platform\n\n## Executive Summary\n\n${analyze-security.reasoning}\n\n## Detailed Reconnaissance Results\n\n### Full System Scan\n```json\n${full-recon}\n```\n\n### Vulnerability Analysis\n```json\n${vulnerability-scan}\n```\n\n## Remediation Plan\n\nSee `remediation_plan.py` for automated remediation tracking.\n"
      }
    },
    {
      "id": "save-remediation-script",
      "type": "mcp_call",
      "mcp_server": "file_tools",
      "tool": "write_file",
      "params": {
        "path": "remediation_plan.py",
        "content": "${generate-remediation-plan.code}"
      }
    }
  ],
  "edges": [
    {
      "source": "full-recon",
      "target": "vulnerability-scan"
    },
    {
      "source": "vulnerability-scan",
      "target": "analyze-security"
    },
    {
      "source": "analyze-security",
      "target": "generate-remediation-plan"
    },
    {
      "source": "generate-remediation-plan",
      "target": "save-full-report"
    },
    {
      "source": "generate-remediation-plan",
      "target": "save-remediation-script"
    }
  ]
}
