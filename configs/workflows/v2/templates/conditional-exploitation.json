{
  "template_id": "conditional-exploitation",
  "name": "Conditional Exploitation",
  "description": "Scans target for vulnerabilities and conditionally exploits if critical findings are detected",
  "category": "pentesting",
  "tags": ["exploit", "conditional", "vulnerability", "advanced"],
  "version": "1.0.0",
  "author": "adcl.io",
  "workflow": {
    "workflow_id": "conditional-exploit-template",
    "version": "2.0",
    "ui_metadata": {
      "zoom": 1.0,
      "viewport": {"x": 0, "y": 0}
    },
    "nodes": [
      {
        "node_id": "trigger-1",
        "node_type": "trigger",
        "label": "Manual Trigger",
        "trigger_type": "manual",
        "position": {"x": 150, "y": 100}
      },
      {
        "node_id": "vuln-scan",
        "node_type": "agent",
        "agent_id": "vulnerability-scanner",
        "label": "Vulnerability Scan",
        "timeout": 900,
        "position": {"x": 150, "y": 250}
      },
      {
        "node_id": "check-severity",
        "node_type": "utility",
        "utility_type": "if",
        "label": "Critical Vulns?",
        "utility_config": {
          "condition": "{{$node['vuln-scan'].severity == 'critical'}}"
        },
        "position": {"x": 150, "y": 400}
      },
      {
        "node_id": "exploit",
        "node_type": "agent",
        "agent_id": "metasploit-exploit",
        "label": "Run Exploit",
        "timeout": 600,
        "position": {"x": 50, "y": 550}
      },
      {
        "node_id": "report-safe",
        "node_type": "agent",
        "agent_id": "report-generator",
        "label": "Generate Safe Report",
        "timeout": 120,
        "position": {"x": 250, "y": 550}
      },
      {
        "node_id": "output-1",
        "node_type": "output",
        "label": "Results",
        "format": "json",
        "position": {"x": 150, "y": 700}
      }
    ],
    "edges": [
      {"from": "trigger-1", "to": "vuln-scan"},
      {"from": "vuln-scan", "to": "check-severity"},
      {"from": "check-severity", "to": "exploit", "source_handle": "true"},
      {"from": "check-severity", "to": "report-safe", "source_handle": "false"},
      {"from": "exploit", "to": "output-1"},
      {"from": "report-safe", "to": "output-1"}
    ]
  }
}
