{
  "workflow_id": "struts2-s2-045-auto-exploit",
  "name": "Struts2 S2-045 Automated Exploitation",
  "description": "Automated workflow for exploiting Apache Struts2 CVE-2017-5638 (S2-045) RCE vulnerability. Verifies vulnerability, executes exploit, validates success, and generates report.",
  "nodes": [
    {
      "node_id": "verify-vulnerability",
      "agent_id": "struts2_s2_045_exploit",
      "timeout": 30,
      "description": "Stage 1: Verify target is vulnerable to S2-045 OGNL injection",
      "input": {
        "mcp_tool": "verify_vulnerability",
        "target": "${{target}}",
        "port": "${{port:8080}}"
      },
      "position": {
        "x": 100,
        "y": 100
      },
      "ui": {
        "width": 220,
        "height": 160,
        "color": "#4A90E2"
      }
    },
    {
      "node_id": "execute-recon",
      "agent_id": "struts2_s2_045_exploit",
      "timeout": 30,
      "description": "Stage 2: Execute reconnaissance command (id)",
      "input": {
        "mcp_tool": "exploit_rce",
        "target": "${{target}}",
        "port": "${{port:8080}}",
        "command": "id"
      },
      "position": {
        "x": 400,
        "y": 100
      },
      "ui": {
        "width": 220,
        "height": 160,
        "color": "#E94B3C"
      },
      "condition": {
        "expression": "${{verify-vulnerability.vulnerable}} == true",
        "on_false": "skip"
      }
    },
    {
      "node_id": "execute-whoami",
      "agent_id": "struts2_s2_045_exploit",
      "timeout": 30,
      "description": "Stage 3: Execute whoami command",
      "input": {
        "mcp_tool": "exploit_rce",
        "target": "${{target}}",
        "port": "${{port:8080}}",
        "command": "whoami"
      },
      "position": {
        "x": 700,
        "y": 100
      },
      "ui": {
        "width": 220,
        "height": 160,
        "color": "#E94B3C"
      },
      "condition": {
        "expression": "${{execute-recon.success}} == true",
        "on_false": "skip"
      }
    },
    {
      "node_id": "execute-uname",
      "agent_id": "struts2_s2_045_exploit",
      "timeout": 30,
      "description": "Stage 4: Execute uname -a for system info",
      "input": {
        "mcp_tool": "exploit_rce",
        "target": "${{target}}",
        "port": "${{port:8080}}",
        "command": "uname -a"
      },
      "position": {
        "x": 1000,
        "y": 100
      },
      "ui": {
        "width": 220,
        "height": 160,
        "color": "#E94B3C"
      },
      "condition": {
        "expression": "${{execute-whoami.success}} == true",
        "on_false": "skip"
      }
    },
    {
      "node_id": "validate-exploitation",
      "agent_id": "exploit-validator-agent",
      "timeout": 30,
      "description": "Stage 5: Validate successful RCE exploitation",
      "input": {
        "validation_method": "rce",
        "command_output": "${{execute-recon.output}}",
        "expected_pattern": "uid=\\d+.*gid=\\d+"
      },
      "position": {
        "x": 400,
        "y": 300
      },
      "ui": {
        "width": 220,
        "height": 160,
        "color": "#6BCF7F"
      },
      "condition": {
        "expression": "${{execute-recon.success}} == true",
        "on_false": "skip"
      }
    },
    {
      "node_id": "generate-report",
      "agent_id": "report-generator-agent",
      "timeout": 60,
      "description": "Stage 6: Generate exploitation report with proof",
      "input": {
        "target": "${{target}}",
        "cve_id": "CVE-2017-5638",
        "vulnerability": "Apache Struts2 S2-045 OGNL Injection RCE",
        "vulnerable": "${{verify-vulnerability.vulnerable}}",
        "exploit_results": {
          "id_output": "${{execute-recon.output}}",
          "whoami_output": "${{execute-whoami.output}}",
          "uname_output": "${{execute-uname.output}}"
        },
        "validation": "${{validate-exploitation}}",
        "report_format": "pentest_standard"
      },
      "position": {
        "x": 700,
        "y": 300
      },
      "ui": {
        "width": 220,
        "height": 160,
        "color": "#9B59B6"
      }
    }
  ],
  "edges": [
    {
      "from": "verify-vulnerability",
      "to": "execute-recon",
      "ui": {
        "animated": true,
        "label": "if vulnerable"
      }
    },
    {
      "from": "execute-recon",
      "to": "execute-whoami",
      "ui": {
        "animated": true,
        "label": "if success"
      }
    },
    {
      "from": "execute-whoami",
      "to": "execute-uname",
      "ui": {
        "animated": true,
        "label": "if success"
      }
    },
    {
      "from": "execute-recon",
      "to": "validate-exploitation",
      "ui": {
        "animated": true,
        "label": "validate"
      }
    },
    {
      "from": "validate-exploitation",
      "to": "generate-report",
      "ui": {
        "animated": true
      }
    }
  ],
  "parameters": {
    "target": {
      "type": "string",
      "required": true,
      "description": "Target IP address or hostname",
      "example": "192.168.1.50"
    },
    "port": {
      "type": "integer",
      "required": false,
      "default": 8080,
      "description": "Target port (default: 8080)",
      "example": 8080
    }
  },
  "metadata": {
    "cve_id": "CVE-2017-5638",
    "cvss_score": 10.0,
    "difficulty": "easy",
    "category": "web",
    "tags": ["rce", "web", "java", "injection", "struts2"],
    "author": "ADCL",
    "created_at": "2025-01-09",
    "requires_vulhub": true,
    "vulhub_target_id": "struts2-s2-045"
  },
  "version": "2.0",
  "ui_metadata": {
    "zoom": 0.8,
    "viewport": {
      "x": 0,
      "y": 0
    },
    "description_visible": true
  }
}
